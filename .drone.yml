---
kind: pipeline
name: default

steps:
- name: build
  image: monachus/hugo:v0.58-2
  commands:
    - hugo check
    - hugo
  when:
    branch: [ master ]

- name: docker-publish
  image: plugins/docker
  settings:
    registry: 
      from_secret: docker_registry
    username:
      from_secret: docker_username
    password:
      from_secret: docker_password
    repo: channel11/new_blog
  when:
    branch: [ master ]

- name: telegram
  image: appleboy/drone-telegram
  to: 
    from_secret: notify_telegram_id # 57439615
  token:
    from_secret: notify_telegram_token
  message: Сборка www.channel11.info завершена.
  when:
    branch: [ master ]
